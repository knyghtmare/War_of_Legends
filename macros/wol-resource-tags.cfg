#textdomain wesnoth-War_of_Legends

# i had to rename this file since the load order
# does not seem to read the uni advancements before this file

# events, lua, and unit advancements loader

# multiplayer
[resource]
    id=WOL_resource_loader_advancements_MP

    {ENABLE_TROLL_SHAMAN}
    {ENABLE_TROLL_BOULDERLOBBER}
    {ENABLE_TROLL_WARMONGER}
    {ENABLE_TROLL_WARBANNER}
    {ENABLE_ORC_MARAUDER}

    {ENABLE_GOBLIN_CUTTHROAT}
    {ENABLE_GOBLIN_SPEARMASTER}
    {ENABLE_GOBLIN_TRUMPETER}
    {ENABLE_ORC_HIGH_WARLORD}
    # {ENABLE_GREAT_OGRE}

    {ENABLE_DEATH_BARON}
    {ENABLE_SHADOWBACK}
    {ENABLE_ANCIENT_LICH}

    {ENABLE_WOSE_SHAMAN}

    # {ENABLE_MOUNTED_BOWMAN}
    # {ENABLE_TITANIUM_DECIMATOR}
    [modify_unit_type]
        type="Spearman"
        remove_advancement="Swordsman"
    [/modify_unit_type]
    [modify_unit_type]
        type="Mage"
        remove_advancement="White Mage"
    [/modify_unit_type]
    {ENABLE_JAVELIN_MASTER}
    {ENABLE_LOYALIST_CROSSBOWMAN}

    # {ENABLE_LAVA_BEHEMOTH}

    {ENABLE_SAURIAN_SPEARTHROWER}

    {ENABLE_DRAKE_ADVENTURER}
    {ENABLE_DRAKE_SMASHER}
    {ENABLE_ARMAGEDDON_DRAKE}

    {ENABLE_DWARVISH_RUNESMITH}
    {ENABLE_DWARVISH_ARCANISTER}

    {ENABLE_GRYPHON_THUNDERLORD}

    {ENABLE_PARAGON}

    {ENABLE_ELVISH_VANQUISHER}

    {ENABLE_WOLF_ADVANCEMENT}
[/resource]

# singleplayer
[resource]
    id=WOL_resource_loader_advancements_SP

    {ENABLE_TROLL_SHAMAN}
    {ENABLE_TROLL_BOULDERLOBBER}
    {ENABLE_TROLL_WARMONGER}
    {ENABLE_TROLL_WARBANNER}
    {ENABLE_ORC_MARAUDER}

    {ENABLE_GOBLIN_CUTTHROAT}
    {ENABLE_GOBLIN_SPEARMASTER}
    {ENABLE_GOBLIN_GRUNT}
    {ENABLE_GOBLIN_TRUMPETER}
    {ENABLE_ORC_HIGH_WARLORD}
    {ENABLE_ORC_FLAMEBOW}
    {ENABLE_GREAT_OGRE}

    {ENABLE_DEATH_BARON}
    {ENABLE_SHADOWBACK}
    {ENABLE_ANCIENT_LICH}

    {ENABLE_WOSE_SHAMAN}

    {ENABLE_MOUNTED_BOWMAN}
    {ENABLE_TITANIUM_DECIMATOR}
    [modify_unit_type]
        type="Spearman"
        remove_advancement="Swordsman"
    [/modify_unit_type]
    [modify_unit_type]
        type="Mage"
        remove_advancement="White Mage"
    [/modify_unit_type]
    {ENABLE_JAVELIN_MASTER}
    {ENABLE_LOYALIST_CROSSBOWMAN}

    {ENABLE_LAVA_BEHEMOTH}

    {ENABLE_SAURIAN_SPEARTHROWER}

    {ENABLE_DRAKE_ADVENTURER}
    {ENABLE_DRAKE_SMASHER}
    {ENABLE_ARMAGEDDON_DRAKE}

    {ENABLE_DWARVISH_RUNESMITH}
    {ENABLE_DWARVISH_ARCANISTER}

    {ENABLE_GRYPHON_THUNDERLORD}
    {ENABLE_ELVISH_VANQUISHER}

    {ENABLE_PARAGON}
[/resource]

# AOI: the rework
# specific resource
[resource]
    id=WOL_resource_loader_advancements_AOIRW

    {ENABLE_TROLL_SHAMAN}
    {ENABLE_TROLL_BOULDERLOBBER}
    {ENABLE_TROLL_WARMONGER}
    {ENABLE_TROLL_WARBANNER}
    {ENABLE_ORC_MARAUDER}

    {ENABLE_GOBLIN_CUTTHROAT}
    {ENABLE_GOBLIN_SPEARMASTER}
    {ENABLE_GOBLIN_TRUMPETER}
    {ENABLE_ORC_HIGH_WARLORD}
    {ENABLE_GREAT_OGRE}
    {ENABLE_WOSE_SHAMAN}

    {ENABLE_SAURIAN_SPEARTHROWER}

    # fun fact: these have to be included
    # because there are dwarves and drakes in
    # one scenario
    {ENABLE_DRAKE_ADVENTURER}
    {ENABLE_ARMAGEDDON_DRAKE}

    {ENABLE_DWARVISH_RUNESMITH}
    {ENABLE_DWARVISH_ARCANISTER}

    {ENABLE_GRYPHON_THUNDERLORD}
[/resource]

[resource]
    id=WOL_resource_abilities_events_all

    [event]
        name="preload"
        first_time_only=no
        [lua]
            code= << wesnoth.require "~add-ons/War_of_Legends/lua/theme.lua" >>
        [/lua]
    [/event]

    # loyalists
    {WOL_RADIANCE_EVENT}
    # Undead
    {FROST_NOVA_EVENT}
    {WOL_DEATH_CLOUD_EVENT}
    # Nightmares
    {~add-ons/War_of_Legends/macros/curse-global-events.cfg}
    {TERRAIN_LINK_GLOBAL_EVENTS}
    # Quenoth Elves
    {WEAPON_SPECIAL_DAZE_EVENTS}
    {ABILITY_DISENGAGE_EVENTS}
    # Steelhive
    {ABILITY_STEELHIVE_EVENTS}
    
    # Aqua Mage freezes
    {FROZEN_EVENTS}
[/resource]

# individual resources
[resource]
    id=WOL_resource_abilities_events_nightmares

    [event]
        name="preload"
        first_time_only=no
        [lua]
            code= << wesnoth.require "~add-ons/War_of_Legends/lua/theme.lua" >>
        [/lua]
    [/event]

    {~add-ons/War_of_Legends/macros/curse-global-events.cfg}
    {TERRAIN_LINK_GLOBAL_EVENTS}
[/resource]

[resource]
    id=WOL_resource_events_freezes
    
    {FROZEN_EVENTS}
[/resource]

[resource]
    id=WOL_resource_abilities_events_radiance

    {WOL_RADIANCE_EVENT}
[/resource]

[resource]
    id=WOL_resource_abilities_events_quenoth

    [event]
        name="preload"
        first_time_only=no
        [lua]
            code= << wesnoth.require "~add-ons/War_of_Legends/lua/theme.lua" >>
        [/lua]
    [/event]

    {WEAPON_SPECIAL_DAZE_EVENTS}
    {ABILITY_DISENGAGE_EVENTS}
[/resource]

[resource]
    id=WOL_resource_abilities_events_steelhive

    [event]
        name="preload"
        first_time_only=no
        [lua]
            code= << wesnoth.require "~add-ons/War_of_Legends/lua/theme.lua" >>
        [/lua]
    [/event]

    {ABILITY_STEELHIVE_EVENTS}
[/resource]

[resource]
    id=WOL_resource_abilities_events_undead

    {WOL_DEATH_CLOUD_EVENT}
    {FROST_NOVA_EVENT}
[/resource]

[resource]
    id=WOL_resource_AMLA_system

    {~add-ons/War_of_Legends/macros/wol-amla-system-global-events.cfg}
[/resource]

# deep elf faction resource
[resource]
    id=wol_deep_elves_minotaur_upkeep

    [event]
        name=unit placed
        first_time_only=no

        [filter]
            type=Forgotten Minotaur
        [/filter]

        [lua]
            code=<<
                -- get target unit
                local ecx = wesnoth.current.event_context
                local unit = wesnoth.units.get(ecx.x1, ecx.y1)

                if not unit.variables.upkeep_adjusted then

                    -- apparently, using unit.upkeep here means: "full" - 1 
                    unit.upkeep = unit.level - 1
                    -- do not allow it to stack
                    unit.variables.upkeep_adjusted = true
                    -- debug message to check it worked or not
                    print("%s at (%d,%d) has been adjusted", unit.id, unit.x, unit.y)
                end
            >>
        [/lua]
    [/event]
[/resource]
[resource]
    id=wol_resource_abilities_events_deep_elves

    {WEAPON_SPECIAL_HUNTER_EVENT}
    {WEAPON_SPECIAL_WILL_OF_SHASSAGOTH_EVENT}
    {WEAPON_SPECIAL_KNOCKBACK_EVENT}
    {WEAPON_SPECIAL_ETHER_GRIP_EVENTS}
    {ABILITY_LITHIC_IDOL_EVENTS}
    {ABILITY_SPURT_EVENT}
    {WEAPON_SPECIAL_TRAMPLE_EVENT}

    [load_resource]
        id=wol_deep_elves_minotaur_upkeep
    [/load_resource]
[/resource]

# Mp era resources
[resource]
    id=WOL_resource_mp_era

    [load_resource]
        id=WOL_resource_abilities_events_radiance
    [/load_resource]

    [load_resource]
        id=WOL_resource_abilities_events_quenoth
    [/load_resource]

    [load_resource]
        id=WOL_resource_abilities_events_undead
    [/load_resource]

    [load_resource]
        id=WOL_resource_abilities_events_nightmares
    [/load_resource]

    [load_resource]
        id=wol_resource_abilities_events_deep_elves
    [/load_resource]

    [load_resource]
        id=WOL_resource_loader_advancements_MP
    [/load_resource]
[/resource]

# for world conquest
[resource]
    id=WOL_resource_WC_enemy_array

    [event]
        name = "wc2_init_enemy"
        id="wc2_init_enemy"
        [filter_conditional]
            [variable]
                name="wc2_enemy_army.length"
                equals=0
            [/variable]
        [/filter_conditional]
        [set_variables]
            name = "wc2_enemy_army"
            [literal]
                factions_available = "1,1,1,1,
                                      2,2,2,2,
                                      3,3,3,3,
                                      4,4,4,4,
                                      5,5,5,5,
                                      6,6,6,6,
                                      7,7,7,7,
                                      8,8,8,8,
                                      9,9,9,9,
                                      10,10,10,10,
                                      11,11,11,11,
                                      12,12,12,12,
                                      13,13,13,13,
                                      14,14,14,14,
                                      15,15,15,15,
                                      16,16,16,16,
                                      17,17,17,17,
                                      18,18,18,18"
                # Windsong
                [group]
                    allies_available="2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18"
                    id = "windsong"
                    recruit= "Seeker, Scribe, Weaver, Sky Shard, Courier, Gatekeeper"
                    [recall]
                        level2 = "Envoy, Skyrunner, Pathfinder, Heretic, Emissary, Reaver, Savant"
                        level3 = "Stormbringer, Farstrider, Warmonger, Dreadnought, Arbiter, Rune Forger"
                    [/recall]
                    [commander]
                        level1 = "Seeker, Scribe, Weaver, Sky Shard, Courier, Gatekeeper"
                        level2 = "Envoy, Skyrunner, Pathfinder, Heretic, Emissary, Reaver, Savant"
                        level3 = "Stormbringer, Farstrider, Warmonger, Dreadnought, Arbiter, Rune Forger"
                    [/commander]
                    [leader]
                        level2 = "Prophetess"
                        level3 = "Ascendant"
                        recruit= "Seeker, Scribe, Weaver, Sky Shard, Courier, Gatekeeper"
                    [/leader]
                    [leader]
                        level2 = "Heretic"
                        level3 = "Warmonger"
                        recruit= "Seeker, Scribe, Weaver, Sky Shard, Courier, Gatekeeper"
                    [/leader]
                    [leader]
                        level2 = "Arbiter"
                        level3 = "Librarian"
                        recruit= "Seeker, Scribe, Weaver, Sky Shard, Courier, Gatekeeper"
                    [/leader]
                    [leader]
                        level2 = "Skyrunner"
                        level3 = "Stormbringer"
                        recruit= "Seeker, Scribe, Weaver, Sky Shard, Courier, Gatekeeper"
                    [/leader]
                [/group]

                # Minotaurs
                [group]
                    allies_available="1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18"
                    id = "minotaurs"
                    recruit= "Minotaur Gore, Minotaur Cutthroat, Minotaur Shaman, Minotaur Behemoth, Centaur Warden, Gnoll, Boar Rider"
                    [recall]
                        level2 = "Minotaur Rouser, Minotaur Savage, Minotaur Slayer, Minotaur Warlock, Minotaur Ancient Behemoth, Minotaur Mystic, Centaur Sentinel, Gnoll Marksman, Boar Knight"
                        level3 = "Minotaur Overlord, Minotaur Executioner, Minotaur Elder, Centaur Spearmaiden, Gnoll Deadeye, Boar Cataphract"
                    [/recall]
                    [commander]
                        level1 = "Minotaur Gore, Minotaur Cutthroat, Minotaur Shaman, Minotaur Behemoth, Centaur Warden, Gnoll, Boar Rider"
                        level2 = "Minotaur Rouser, Minotaur Savage, Minotaur Slayer, Minotaur Warlock, Minotaur Ancient Behemoth, Minotaur Mystic, Centaur Sentinel, Gnoll Marksman, Boar Knight"
                        level3 = "Minotaur Overlord, Minotaur Executioner, Minotaur Elder, Centaur Spearmaiden, Gnoll Deadeye, Boar Cataphract"
                    [/commander]
                    [leader]
                        level2 = "Minotaur Rouser"
                        level3 = "Minotaur Overlord"
                        recruit= "Minotaur Gore, Minotaur Cutthroat, Minotaur Shaman, Minotaur Behemoth, Centaur Warden, Gnoll, Boar Rider"
                    [/leader]
                    [leader]
                        level2 = "Minotaur Warlock"
                        level3 = "Minotaur Elder"
                        recruit= "Minotaur Gore, Minotaur Cutthroat, Minotaur Shaman, Minotaur Behemoth, Centaur Warden, Gnoll, Boar Rider"
                    [/leader]
                    [leader]
                        level2 = "Minotaur Slayer"
                        level3 = "Minotaur Executioner"
                        recruit= "Minotaur Gore, Minotaur Cutthroat, Minotaur Shaman, Minotaur Behemoth, Centaur Warden, Gnoll, Boar Rider"
                    [/leader]
                    [leader]
                        level2 = "Gnoll Marksman"
                        level3 = "Gnoll Deadeye"
                        recruit= "Minotaur Gore, Minotaur Cutthroat, Minotaur Shaman, Minotaur Behemoth, Centaur Warden, Gnoll, Boar Rider"
                    [/leader]
                [/group]

                # Vampires
                [group]
                    allies_available="1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18"
                    id = "vampires"
                    recruit= "True Vampire Bat, Bloodborn, Fledgeling, Thin Blood, Blood Apprentice, Blood Hulk, Gargoyle"
                    [recall]
                        level2 = "Vampiric Dread Bat, Vampire Noble, Vampire Duelist, Half Blood, Blood Manipulator, Flesh Artisan, Marlgoyle"
                        level3 = "Sire, Mistress, Sword Dancer, Twilight Walker, Day Hunter, Sangel"
                    [/recall]
                    [commander]
                        level1 = "Fledgeling, Thin Blood, Blood Apprentice"
                        level2 = "Vampire Noble, Vampire Duelist, Half Blood, Blood Manipulator, Flesh Artisan"
                        level3 = "Sire, Mistress, Sword Dancer, Twilight Walker, Day Hunter, Sangel"
                    [/commander]
                    [leader]
                        level2 = "Half Blood"
                        level3 = "Twilight Walker"
                        recruit= "True Vampire Bat, Bloodborn, Fledgeling, Thin Blood, Blood Apprentice, Blood Hulk, Gargoyle"
                    [/leader]
                    [leader]
                        level2 = "Blood Manipulator"
                        level3 = "Sangel"
                        recruit= "True Vampire Bat, Bloodborn, Fledgeling, Thin Blood, Blood Apprentice, Blood Hulk, Gargoyle"
                    [/leader]
                    [leader]
                        level2 = "Vampire Duelist"
                        level3 = "Sword Dancer"
                        recruit= "True Vampire Bat, Bloodborn, Fledgeling, Thin Blood, Blood Apprentice, Blood Hulk, Gargoyle"
                    [/leader]
                    [leader]
                        level2 = "Vampire Noble"
                        level3 = "Mistress"
                        recruit= "True Vampire Bat, Bloodborn, Fledgeling, Thin Blood, Blood Apprentice, Blood Hulk, Gargoyle"
                    [/leader]
                [/group]

                # Aragwaithi
                [group]
                    allies_available="1,2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18"
                    id = "aragwaithi"
                    recruit= "Aragwaith Swordsman, Aragwaith Adept, Aragwaith Archer, Aragwaith Spearman, Aragwaith Eagle Rider, Aragwaith Scout"
                    [recall]
                        level2 = "Aragwaith Guard, Aragwaith Enchantress, Aragwaith Strongbow, Aragwaith Pikeman, Aragwaith Eagle Master, Aragwaith Lancer"
                        level3 = "Aragwaith Shield Guard, Aragwaith Sorceress, Aragwaith Greatbow, Aragwaith Guardian, Aragwaith Captain, Aragwaith Silver Shield"
                    [/recall]
                    [commander]
                        level1 = "Aragwaith Swordsman, Aragwaith Adept, Aragwaith Archer, Aragwaith Spearman, Aragwaith Eagle Rider, Aragwaith Scout"
                        level2 = "Aragwaith Guard, Aragwaith Enchantress, Aragwaith Strongbow, Aragwaith Pikeman, Aragwaith Eagle Master, Aragwaith Lancer"
                        level3 = "Aragwaith Shield Guard, Aragwaith Sorceress, Aragwaith Greatbow, Aragwaith Guardian, Aragwaith Captain, Aragwaith Silver Shield"
                    [/commander]
                    [leader]
                        level2 = "Aragwaith Longswordsman"
                        level3 = "Aragwaith Swordsmaster"
                        recruit= "Aragwaith Swordsman, Aragwaith Adept, Aragwaith Archer, Aragwaith Spearman, Aragwaith Eagle Rider, Aragwaith Scout"
                    [/leader]
                    [leader]
                        level2 = "Aragwaith Strongbow"
                        level3 = "Aragwaith Slayer"
                        recruit= "Aragwaith Swordsman, Aragwaith Adept, Aragwaith Archer, Aragwaith Spearman, Aragwaith Eagle Rider, Aragwaith Scout"
                    [/leader]
                    [leader]
                        level2 = "Aragwaith Guard"
                        level3 = "Aragwaith Shield Guard"
                        recruit= "Aragwaith Swordsman, Aragwaith Adept, Aragwaith Archer, Aragwaith Spearman, Aragwaith Eagle Rider, Aragwaith Scout"
                    [/leader]
                    [leader]
                        level2 = "Aragwaith Captain"
                        level3 = "Aragwaith Ancient Banner"
                        recruit= "Aragwaith Swordsman, Aragwaith Adept, Aragwaith Archer, Aragwaith Spearman, Aragwaith Eagle Rider, Aragwaith Scout"
                    [/leader]
                [/group]

                # Drakes
                [group]
                    allies_available="1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18"
                    id = "drakes"
                    recruit= "Drake Burner, Drake Fighter, Drake Clasher, Drake Glider, Saurian Skirmisher, Saurian Augur"
                    [recall]
                        level2 = "Drake Flare, Fire Drake, Drake Warrior, Drake Arbiter, Drake Thrasher, Sky Drake, Saurian Ambusher, Saurian Spearthrower, Saurian Oracle, Saurian Soothsayer"
                        level3 = "Drake Flameheart, Inferno Drake, Drake Blademaster, Drake Warden, Drake Enforcer, Hurricane Drake, Saurian Flanker, Saurian Javelineer, Saurian Seer, Saurian Prophet"
                    [/recall]
                    [commander]
                        level1 = "Drake Burner, Drake Fighter, Drake Clasher, Drake Glider, Saurian Skirmisher, Saurian Augur"
                        level2 = "Envoy, Skyrunner, Pathfinder, Heretic, Emissary, Reaver, Savant"
                        level3 = "Stormbringer, Farstrider, Warmonger, Dreadnought, Arbiter, Rune Forger"
                    [/commander]
                    [leader]
                        level2 = "Fire Drake"
                        level3 = "Inferno Drake"
                        level4 = "Armageddon Drake"
                        recruit= "Drake Burner, Drake Fighter, Drake Clasher, Drake Glider, Saurian Skirmisher, Saurian Augur"
                    [/leader]
                    [leader]
                        level2 = "Drake Arbiter"
                        level3 = "Drake Warden"
                        recruit= "Drake Burner, Drake Fighter, Drake Clasher, Drake Glider, Saurian Skirmisher, Saurian Augur"
                    [/leader]
                    [leader]
                        level2 = "Saurian Oracle"
                        level3 = "Saurian Prophet"
                        recruit= "Drake Burner, Drake Fighter, Drake Clasher, Drake Glider, Saurian Skirmisher, Saurian Augur"
                    [/leader]
                    [leader]
                        level2 = "Drake Warrior"
                        level3 = "Drake Blademaster"
                        recruit= "Drake Burner, Drake Fighter, Drake Clasher, Drake Glider, Saurian Skirmisher, Saurian Augur"
                    [/leader]
                [/group]

                # Dunefolk
                [group]
                    allies_available="1,2,3,4,5,7,8,9,10,11,12,13,14,15,16,17,18"
                    id = "wol_dunefolk"
                    recruit= "Dune Soldier, Dune Rover, Dune Rider, Dune Herbalist, Dune Skirmisher, Dune Burner, Naga Dirkfang"
                    [recall]
                        level2 = "Dune Swordsman, Dune Spearguard, Dune Captain, Dune Raider, Dune Sunderer, Dune Horse Archer, Dune Alchemist, Dune Apothecary, Dune Strider, Dune Falconer, Dune Scorcher, Dune Explorer, Naga Ringcaster"
                        level3 = "Dune Blademaster, Dune Spearmaster, Dune Warmaster, Dune Marauder, Dune Cataphract, Dune Windbolt, Dune Luminary, Dune Harrier, Dune Sky Hunter, Dune Firetrooper, Dune Wayfarer, Naga Zephyr"
                    [/recall]
                    [commander]
                        level1 = "Dune Soldier, Dune Rover, Dune Rider, Dune Herbalist, Dune Skirmisher, Dune Burner"
                        level2 = "Dune Swordsman, Dune Spearguard, Dune Captain, Dune Raider, Dune Sunderer, Dune Horse Archer, Dune Alchemist, Dune Apothecary, Dune Strider, Dune Falconer, Dune Scorcher, Dune Explorer, Naga Ringcaster"
                        level3 = "Dune Blademaster, Dune Spearmaster, Dune Warmaster, Dune Marauder, Dune Cataphract, Dune Windbolt, Dune Luminary, Dune Harrier, Dune Sky Hunter, Dune Firetrooper, Dune Wayfarer, Naga Zephyr"
                    [/commander]
                    [leader]
                        level2 = "Dune Captain"
                        level3 = "Dune Warmaster"
                        recruit= "Dune Soldier, Dune Rover, Dune Rider, Dune Herbalist, Dune Skirmisher, Dune Burner, Naga Dirkfang"
                    [/leader]
                    [leader]
                        level2 = "Dune Spearguard"
                        level3 = "Dune Spearmaster"
                        recruit= "Dune Soldier, Dune Rover, Dune Rider, Dune Herbalist, Dune Skirmisher, Dune Burner, Naga Dirkfang"
                    [/leader]
                    [leader]
                        level2 = "Dune Falconer"
                        level3 = "Dune Sky Hunter"
                        recruit= "Dune Soldier, Dune Rover, Dune Rider, Dune Herbalist, Dune Skirmisher, Dune Burner, Naga Dirkfang"
                    [/leader]
                    [leader]
                        level2 = "Dune Apothecary"
                        level3 = "Dune Luminary"
                        recruit= "Dune Soldier, Dune Rover, Dune Rider, Dune Herbalist, Dune Skirmisher, Dune Burner, Naga Dirkfang"
                    [/leader]
                [/group]

                # Dark Legion
                [group]
                    allies_available="1,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17,18"
                    id = "dark_legion"
                    recruit= "Legion Archer, Legion Soldier, Legion Spearman, Legion Trooper, Legion Horseman, Legion Medic, Naga Guard"
                    [recall]
                        level2 = "Legion Crossbowman, Legion Swordsman, Legion Subaltern, Legion Berserker, Legion Longbowman, Legion Halberdier, Legion Gunner, Legion Knight, Legion Crusher, Legion Guardian, Legion Pillager, Naga Shield Guard, Legion Healer"
                        level3 = "Legion Arbalestier, Legion Champion, Legion Commander, Legion Elite Longbowman, Legion Executioner, Legion Enforcer, Legion Cavalier, Legion Sentinel, Naga High Guard, Legion Doctor"
                    [/recall]
                    [commander]
                        level1 = "Legion Archer, Legion Soldier, Legion Spearman, Legion Trooper, Legion Horseman, Legion Medic, Naga Guard"
                        level2 = "Legion Crossbowman, Legion Swordsman, Legion Subaltern, Legion Berserker, Legion Longbowman, Legion Halberdier, Legion Gunner, Legion Knight, Legion Crusher, Legion Guardian, Legion Pillager, Naga Shield Guard, Legion Healer"
                        level3 = "Legion Arbalestier, Legion Champion, Legion Commander, Legion Elite Longbowman, Legion Executioner, Legion Enforcer, Legion Cavalier, Legion Sentinel, Naga High Guard, Legion Doctor"
                    [/commander]
                    [leader]
                        level2 = "Legion Crossbowman"
                        level3 = "Legion Arbalestier"
                        recruit= "Legion Archer, Legion Soldier, Legion Spearman, Legion Trooper, Legion Horseman, Legion Medic, Naga Guard"
                    [/leader]
                    [leader]
                        level2 = "Legion Halberdier"
                        level3 = "Legion Executioner"
                        recruit= "Legion Archer, Legion Soldier, Legion Spearman, Legion Trooper, Legion Horseman, Legion Medic, Naga Guard"
                    [/leader]
                    [leader]
                        level2 = "Legion Swordsman"
                        level3 = "Legion Champion"
                        recruit= "Legion Archer, Legion Soldier, Legion Spearman, Legion Trooper, Legion Horseman, Legion Medic, Naga Guard"
                    [/leader]
                    [leader]
                        level2 = "Legion Subaltern"
                        level3 = "Legion Commander"
                        recruit= "Legion Archer, Legion Soldier, Legion Spearman, Legion Trooper, Legion Horseman, Legion Medic, Naga Guard"
                    [/leader]
                [/group]

                # Outlaws
                [group]
                    allies_available="1,2,3,4,5,6,7,9,10,11,12,13,14,15,16,17,18"
                    id = "outlaws"
                    recruit= "Tracker, Axethrower, Shadow Initiate, Poacher, Footpad, Thug, Thief, Young Ogre, Shaman"
                    [recall]
                        level2 = "Huntress, Outlaw, Axeman, Shadow Mage, Bandit, Rogue, Trapper, Ogre, Wizard"
                        level3 = "Prowler, Fugitive, Axemaster, Shadow Lord, Highwayman, Huntsman, Ranger, Sorcerer"
                    [/recall]
                    [commander]
                        level1 = "Tracker, Axethrower, Shadow Initiate, Poacher, Footpad, Thug, Thief, Young Ogre, Shaman"
                        level2 = "Huntress, Outlaw, Axeman, Shadow Mage, Bandit, Rogue, Trapper, Ogre, Wizard"
                        level3 = "Prowler, Fugitive, Axemaster, Shadow Lord, Highwayman, Huntsman, Ranger, Sorcerer"
                    [/commander]
                    [leader]
                        level2 = "Huntress"
                        level3 = "Prowler"
                        recruit= "Tracker, Axethrower, Shadow Initiate, Poacher, Footpad, Thug, Thief, Young Ogre, Shaman"
                    [/leader]
                    [leader]
                        level2 = "Bandit"
                        level3 = "Highwayman"
                        recruit= "Tracker, Axethrower, Shadow Initiate, Poacher, Footpad, Thug, Thief, Young Ogre, Shaman"
                    [/leader]
                    [leader]
                        level2 = "Shadow Mage"
                        level3 = "Shadow Lord"
                        recruit= "Tracker, Axethrower, Shadow Initiate, Poacher, Footpad, Thug, Thief, Young Ogre, Shaman"
                    [/leader]
                    [leader]
                        level2 = "Axeman"
                        level3 = "Axemaster"
                        recruit= "Tracker, Axethrower, Shadow Initiate, Poacher, Footpad, Thug, Thief, Young Ogre, Shaman"
                    [/leader]
                [/group]

                # Loyalists
                [group]
                    allies_available="1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18"
                    id = "wol_loyalists"
                    recruit= "Infantryman, Heavy Infantryman, Bowman, Spearman, Fencer, Cavalryman, Horseman, Mage"
                    [recall]
                        level2 = "Swordsman, Chevalier, Shock Trooper, Longbowman, Crossbowman, Pikeman, Duelist, Dragoon, Knight, Lancer, Javelineer, White Mage, Red Mage"
                        level3 = "Royal Guard, Crusader, Iron Mauler, Master Bowman, Halberdier, Master at Arms, Cavalier, Grand Knight, Paladin, Mage of Light, Javelin Master, Arch Mage, Silver Mage"
                    [/recall]
                    [commander]
                        level1 = "Infantryman, Heavy Infantryman, Bowman, Spearman, Fencer, Cavalryman, Horseman, Mage"
                        level2 = "Swordsman, Chevalier, Shock Trooper, Longbowman, Crossbowman, Pikeman, Duelist, Dragoon, Knight, Lancer, Javelineer, White Mage, Red Mage"
                        level3 = "Royal Guard, Crusader, Iron Mauler, Master Bowman, Halberdier, Master at Arms, Cavalier, Grand Knight, Paladin, Mage of Light, Javelin Master, Arch Mage, Silver Mage"
                    [/commander]
                    [leader]
                        level2 = "Chevalier"
                        level3 = "Crusader"
                        recruit= "Infantryman, Heavy Infantryman, Bowman, Spearman, Fencer, Cavalryman, Horseman, Mage"
                    [/leader]
                    [leader]
                        level2 = "Swordsman"
                        level3 = "Royal Guard"
                        recruit= "Infantryman, Heavy Infantryman, Bowman, Spearman, Fencer, Cavalryman, Horseman, Mage"
                    [/leader]
                    [leader]
                        level2 = "Shock Trooper"
                        level3 = "Iron Mauler"
                        recruit= "Infantryman, Heavy Infantryman, Bowman, Spearman, Fencer, Cavalryman, Horseman, Mage"
                    [/leader]
                    [leader]
                        level2 = "Longbowman"
                        level3 = "Master Bowman"
                        recruit= "Infantryman, Heavy Infantryman, Bowman, Spearman, Fencer, Cavalryman, Horseman, Mage"
                    [/leader]
                [/group]

                # Sylvans
                [group]
                    allies_available="1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,17,18"
                    id = "sylvans"
                    recruit= "Elvish Fighter, Elvish Acolyte, Elvish Shaman, Elvish Archer, Elvish Hunter, Elvish Scout, Faerie Sprite, Wose"
                    [recall]
                        level2 = "Elvish Hero, Elvish Captain, Elvish Ranger, Elvish Marksman, Elvish Rider, Elvish Druid, Elvish Sorceress, Elvish Ascetic, Elvish Trapper, Elder Wose, Wose Shaman, Faerie Sprite, Fire Faerie"
                        level3 = "Elvish Champion, Elvish Marshal, Elvish Avenger, Elvish Sharpshooter, Elvish Outrider, Elvish Shyde, Elvish Enchantress, Elvish Mystic, Elvish Prowler, Ancient Wose, Faerie Dryad, Faerie Spirit"
                    [/recall]
                    [commander]
                        level1 = "Elvish Fighter, Elvish Acolyte, Elvish Shaman, Elvish Archer, Elvish Hunter"
                        level2 = "Elvish Hero, Elvish Ascetic, Elvish Sorceress, Elvish Ranger, Elvish Trapper"
                        level3 = "Elvish Champion, Elvish Mystic, Elvish Enchantress, Elvish Avenger, Elvish Prowler"
                    [/commander]
                    [leader]
                        level2 = "Elvish Ranger"
                        level3 = "Elvish Avenger"
                        recruit= "Elvish Fighter, Elvish Acolyte, Elvish Shaman, Elvish Archer, Elvish Hunter, Elvish Scout, Faerie Sprite, Wose"
                    [/leader]
                    [leader]
                        level2 = "Elvish Ascetic"
                        level3 = "Elvish Mystic"
                        level4 = "Elvish Avatar"
                        recruit= "Elvish Fighter, Elvish Acolyte, Elvish Shaman, Elvish Archer, Elvish Hunter, Elvish Scout, Faerie Sprite, Wose"
                    [/leader]
                    [leader]
                        level2 = "Elvish Captain"
                        level3 = "Elvish Marshal"
                        recruit= "Elvish Fighter, Elvish Acolyte, Elvish Shaman, Elvish Archer, Elvish Hunter, Elvish Scout, Faerie Sprite, Wose"
                    [/leader]
                    [leader]
                        level2 = "Elvish Sorceress"
                        level3 = "Elvish Enchantress"
                        level4 = "Elvish Sylph"
                        recruit= "Elvish Fighter, Elvish Acolyte, Elvish Shaman, Elvish Archer, Elvish Hunter, Elvish Scout, Faerie Sprite, Wose"
                    [/leader]
                [/group]

                # Quenoth
                [group]
                    allies_available="1,2,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18"
                    id = "quenoth"
                    recruit= "Quenoth Scout, Quenoth Fighter, Tauroch Rider, Fire Guardian, Quenoth Mystic, Naga Guard"
                    [recall]
                        level2 = "Quenoth Warrior, Quenoth Flanker, Tauroch Vanguard, Tauroch Stalwart, Quenoth Sun Singer, Quenoth Shaman, Quenoth Archer, Quenoth Pathfinder, Fire Wraith, Naga Shield Guard"
                        level3 = "Quenoth Champion, Quenoth Ranger, Tauroch Protector, Tauroch Flagbearer, Quenoth Sun Sylph, Quenoth Marksman, Quenoth Outrider, Quenoth Druid, Naga High Guard"
                    [/recall]
                    [commander]
                        level1 = "Quenoth Scout, Quenoth Fighter, Tauroch Rider, Fire Guardian, Quenoth Mystic, Naga Guard"
                        level2 = "Quenoth Warrior, Quenoth Flanker, Tauroch Vanguard, Tauroch Stalwart, Quenoth Sun Singer, Quenoth Shaman, Quenoth Archer, Quenoth Pathfinder, Fire Wraith, Naga Shield Guard"
                        level3 = "Quenoth Champion, Quenoth Ranger, Tauroch Protector, Tauroch Flagbearer, Quenoth Sun Sylph, Quenoth Marksman, Quenoth Outrider, Quenoth Druid"
                    [/commander]
                    [leader]
                        level2 = "Tauroch Vanguard"
                        level3 = "Tauroch Flagbearer"
                        recruit= "Quenoth Scout, Quenoth Fighter, Tauroch Rider, Fire Guardian, Quenoth Mystic, Naga Guard"
                    [/leader]
                    [leader]
                        level2 = "Quenoth Warrior"
                        level3 = "Quenoth Champion"
                        recruit= "Quenoth Scout, Quenoth Fighter, Tauroch Rider, Fire Guardian, Quenoth Mystic, Naga Guard"
                    [/leader]
                    [leader]
                        level2 = "Quenoth Shaman"
                        level3 = "Quenoth Druid"
                        level4 = "Quenoth Shyde"
                        recruit= "Quenoth Scout, Quenoth Fighter, Tauroch Rider, Fire Guardian, Quenoth Mystic, Naga Guard"
                    [/leader]
                    [leader]
                        level2 = "Tauroch Stalwart"
                        level3 = "Tauroch Protector"
                        recruit= "Quenoth Scout, Quenoth Fighter, Tauroch Rider, Fire Guardian, Quenoth Mystic, Naga Guard"
                    [/leader]
                [/group]

                # Undead
                [group]
                    allies_available="1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18"
                    id = "wol_undead"
                    recruit= "Skeleton, Skeleton Archer, Skeleton Rider, Ghoul, Ghost, Necro Initiate"
                    [recall]
                        level2 = "Revenant, Deathblade, Death Baron, Bone Shooter, Bone Knight, Necrophage, Wraith, Shadow, Deathmaster"
                        level3 = "Draug, Death Knight, Banebow, Ghast, Spectre, Nightgaunt, Lich Lord"
                    [/recall]
                    [commander]
                        level1 = "Skeleton, Skeleton Archer, Skeleton Rider, Ghoul, Ghost, Necro Initiate"
                        level2 = "Revenant, Deathblade, Death Baron, Bone Shooter, Bone Knight, Necrophage, Wraith, Shadow, Deathmaster"
                        level3 = "Draug, Death Knight, Banebow, Ghast, Spectre, Nightgaunt, Lich Lord"
                    [/commander]
                    [leader]
                        level2 = "Revenant"
                        level3 = "Draug"
                        recruit= "Skeleton, Skeleton Archer, Skeleton Rider, Ghoul, Ghost, Necro Initiate"
                    [/leader]
                    [leader]
                        level2 = "Death Baron"
                        level3 = "Death Knight"
                        recruit= "Skeleton, Skeleton Archer, Skeleton Rider, Ghoul, Ghost, Necro Initiate"
                    [/leader]
                    [leader]
                        level2 = "Necrophage"
                        level3 = "Ghast"
                        recruit= "Skeleton, Skeleton Archer, Skeleton Rider, Ghoul, Ghost, Necro Initiate, Soulless, Dread Bat"
                    [/leader]
                    [leader]
                        level2 = "Deathmaster"
                        level3 = "Lich Lord"
                        level4 = "Elder Lich Lord"
                        recruit= "Skeleton, Skeleton Archer, Skeleton Rider, Ghoul, Ghost, Necro Initiate, Chocobone"
                    [/leader]
                [/group]

                # Northerners
                [group]
                    allies_available="1,2,3,4,5,6,7,8,9,10,11,12,14,15,16,17,18"
                    id = "wol_northerners"
                    recruit = "Orcish Grunt, Orcish Archer, Orcish Assassin, Goblin Spearman, Wolf Rider, Troll Whelp, Orcish Shaman, Naga Fighter"
                    [recall]
                        level2 = "Orcish Warrior, Orcish Marauder, Orcish Crossbowman, Orcish Warlock, Orcish Slayer, Troll, Troll Rocklobber, Troll Shaman, Goblin Pillager, Goblin Knight"
                        level3 = "Orcish Warlord, Orcish Subjugator, Orcish Nightblade, Orcish Sorcerer, Direwolf Rider, Troll Warrior, Troll Boulderlobber"
                    [/recall]
                    [commander]
                        level1 = "Orcish Grunt, Orcish Archer, Orcish Assassin, Wolf Rider, Troll Whelp, Orcish Shaman, Naga Fighter"
                        level2 = "Orcish Warrior, Orcish Marauder, Orcish Crossbowman, Orcish Warlock, Orcish Slayer, Troll, Troll Rocklobber, Troll Shaman, Goblin Pillager, Goblin Knight"
                        level3 = "Orcish Warlord, Orcish Subjugator, Orcish Nightblade, Orcish Sorcerer, Direwolf Rider, Troll Warrior, Troll Boulderlobber"
                    [/commander]
                    [leader]
                        level2 = "Orcish Warrior"
                        level3 = "Orcish Warlord"
                        level4 = "Orcish High Warlord"
                        recruit = "Orcish Grunt, Orcish Archer, Orcish Assassin, Goblin Spearman, Wolf Rider, Troll Whelp, Orcish Shaman, Naga Fighter"
                    [/leader]
                    [leader]
                        level2 = "Orcish Slayer"
                        level3 = "Orcish Nightblade"
                        recruit = "Orcish Grunt, Orcish Archer, Orcish Assassin, Goblin Spearman, Wolf Rider, Troll Whelp, Orcish Shaman, Naga Fighter"
                    [/leader]
                    [leader]
                        level2 = "Orcish Crossbowman"
                        level3 = "Orcish Slurbow"
                        recruit = "Orcish Grunt, Orcish Archer, Orcish Assassin, Goblin Spearman, Wolf Rider, Troll Whelp, Orcish Shaman, Naga Fighter"
                    [/leader]
                [/group]

                # Knalgan Alliance
                [group]
                    allies_available="1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,17,18"
                    id = "wol_knalgan_alliance"
                    recruit = "Dwarvish Fighter, Dwarvish Thunderer, Dwarvish Scout, Dwarvish Guardsman, Dwarvish Ulfserker, Gryphon Rider, Footpad, Poacher, Thief"
                    [recall]
                        level2 = "Dwarvish Steelclad, Dwarvish Runesmith, Dwarvish Thunderguard, Dwarvish Stalwart, Dwarvish Pathfinder, Dwarvish Berserker, Gryphon Master, Outlaw, Trapper, Rogue"
                        level3 = "Dwarvish Lord, Dwarvish Runemaster, Dwarvish Dragonguard, Dwarvish Sentinel, Dwarvish Explorer, Fugitive, Huntsman, Ranger, Assassin"
                    [/recall]
                    [commander]
                        level1 = "Dwarvish Fighter, Dwarvish Thunderer, Dwarvish Scout, Dwarvish Guardsman, Dwarvish Ulfserker, Gryphon Rider, Footpad, Poacher, Thief"
                        level2 = "Dwarvish Steelclad, Dwarvish Runesmith, Dwarvish Thunderguard, Dwarvish Stalwart, Dwarvish Pathfinder, Dwarvish Berserker, Gryphon Master, Outlaw, Trapper, Rogue"
                        level3 = "Dwarvish Lord, Dwarvish Runemaster, Dwarvish Dragonguard, Dwarvish Sentinel, Dwarvish Explorer, Fugitive, Huntsman, Ranger, Assassin"
                    [/commander]
                    [leader]
                        level2 = "Dwarvish Steelclad"
                        level3 = "Dwarvish Lord"
                        recruit = "Dwarvish Fighter, Dwarvish Thunderer, Dwarvish Scout, Dwarvish Guardsman, Dwarvish Ulfserker, Gryphon Rider, Footpad, Poacher, Thief"
                    [/leader]
                    [leader]
                        level2 = "Dwarvish Stalwart"
                        level3 = "Dwarvish Sentinel"
                        recruit = "Dwarvish Fighter, Dwarvish Thunderer, Dwarvish Scout, Dwarvish Guardsman, Dwarvish Ulfserker, Gryphon Rider, Footpad, Poacher, Thief"
                    [/leader]
                    [leader]
                        level2 = "Dwarvish Runesmith"
                        level3 = "Dwarvish Runemaster"
                        level4 = "Dwarvish Arcanister"
                        recruit = "Dwarvish Fighter, Dwarvish Thunderer, Dwarvish Scout, Dwarvish Guardsman, Dwarvish Ulfserker, Gryphon Rider, Footpad, Poacher, Thief"
                    [/leader]
                [/group]

                # Monsters
                [group]
                    allies_available="1,2,3,4,5,6,7,8,9,10,11,12,13,14,16,17,18"
                    id = "wol_monsters"
                    # this looks crazy
                    recruit = "Wolf, Giant Scorpion, Rock Scorpion, Cave Wyrm, Fire Guardian, Ice Ghost, Young Ogre, Blood Bat, Tauroch, Dustbok, Giant Mudcrawler, Frost Stoat, Woodland Boar, Fire Ant, Horned Scarab, Young Gryphon, Bay Horse, Dark Horse, White Horse, Ogre, Gryphon, Water Serpent, Fire Wraith, Jinn, Roc, Great Wolf, Cave Bear"

                    [recall]
                        level2 = "Cave Bear, Jinn, Fire Wraith, Great Icemonax, Roc, Swamp Lizard, Water Serpent, Gryphon, Dread Bat, Great Wolf, Great Horse, Black Horse"
                        level3 = "Wild Wyvern, Giant Spider, Elder Gryphon, Direwolf"
                        level4 = "Yeti, Wyvern Rider"
                    [/recall]
                    [commander]
                        level1 = "Troll Whelp, Young Ogre, Young Gryphon, Mage, Thunder Mage, Wood Mage"
                        level2 = "Troll, Troll Rocklobber, Troll Hero, Ogre, Gryphon, Red Mage, Tempest Mage, Forest Mage"
                        level3 = "Troll Warrior, Troll Boulderlobber, Great Troll, Elder Gryphon, Mage of Storms, Mage of Nature, Arch Mage"
                        level4 = "Wyvern Rider, Great Mage"
                    [/commander]
                    [leader]
                        level2 = "Troll"
                        level3 = "Troll Warrior"
                        level4 = "Troll Warmonger"
                        recruit = "Wolf, Giant Scorpion, Rock Scorpion, Cave Wyrm, Fire Guardian, Ice Ghost, Young Ogre, Blood Bat, Tauroch, Dustbok, Giant Mudcrawler, Frost Stoat, Woodland Boar, Fire Ant, Horned Scarab, Young Gryphon"
                    [/leader]
                    [leader]
                        level3 = "Great Troll"
                        level4 = "Wyvern Rider"
                        level5 = "Fire Dragon"
                        recruit = "Wolf, Giant Scorpion, Rock Scorpion, Cave Wyrm, Fire Guardian, Ice Ghost, Young Ogre, Blood Bat, Tauroch, Dustbok, Giant Mudcrawler, Frost Stoat, Woodland Boar, Fire Ant, Horned Scarab, Young Gryphon"
                    [/leader]
                [/group]

                # Deep Elves
                [group]
                    allies_available="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18"
                    id = "wol_deep_elves"
                    recruit = "Blood Maiden,Lightborn,Priestess of the Vault, Night Maiden, Forgotten Minotaur, Tyrhai Rider, Lesser Wisp, Greater Wisp"
                    [recall]
                        level2 = "Vengeance, Phade, Matriarch, Night Stalker, Vault Lurker, Forgotten Minotaur, Black Tyrhai, Tyrhai Cavalry, Wisp Mother, Elthare"
                        level3 = "Baroness of the Night,Irr,Corrupted,Patroness,Predator,Seer"
                    [/recall]
                    [commander]
                        level1 = "Blood Maiden,Lightborn,Priestess of the Vault, Night Maiden, Tyrhai Rider, Greater Wisp"
                        level2 = "Vengeance, Phade, Matriarch, Night Stalker, Vault Lurker, Forgotten Minotaur, Black Tyrhai, Tyrhai Cavalry, Wisp Mother, Elthare"
                        level3 = "Baroness of the Night,Irr,Corrupted,Patroness,Predator,Seer"
                    [/commander]
                    [leader]
                        level2 = "Phade"
                        level3 = "Irr"
                        recruit = "Blood Maiden,Lightborn,Priestess of the Vault, Night Maiden, Forgotten Minotaur, Tyrhai Rider, Lesser Wisp, Greater Wisp"
                    [/leader]
                    [leader]
                        level2 = "Vengeance"
                        level3 = "Predator"
                        recruit = "Blood Maiden,Lightborn,Priestess of the Vault, Night Maiden, Forgotten Minotaur, Tyrhai Rider, Lesser Wisp, Greater Wisp"
                    [/leader]
                    [leader]
                        level2 = "Matriarch"
                        level3 = "Patroness"
                        level4 = "Harbinger"
                        recruit = "Blood Maiden,Lightborn,Priestess of the Vault, Night Maiden, Forgotten Minotaur, Tyrhai Rider, Lesser Wisp, Greater Wisp"
                    [/leader]
                [/group]

                # Steel Hive
                [group]
                    allies_available="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18"
                    id = "wol_steel_hive"
                    recruit = "Steel Slasher,Steel Oculus,Steel Impaler,Steel Wyrm,Steel Hedron,Steel Larva"
                    [recall]
                        level2 = "Steel Vector,Steel Splicer,Steel Cataract,Steel Skewer,Steel Serpent,Steel Nymph,Steel Choron"
                        level3 = "Steel Vorpal,Steel Fideliant,Steel Astigmatic,Steel Dreadnought,Steel Leviathan,Steel Syren"
                    [/recall]
                    [commander]
                        level1 = "Steel Slasher,Steel Oculus,Steel Impaler,Steel Wyrm,Steel Hedron,Steel Larva"
                        level2 = "Steel Vector,Steel Splicer,Steel Cataract,Steel Skewer,Steel Serpent,Steel Nymph,Steel Choron"
                        level3 = "Steel Vorpal,Steel Fideliant,Steel Astigmatic,Steel Dreadnought,Steel Leviathan,Steel Syren"
                    [/commander]
                    [leader]
                        level2 = "Steel Vector"
                        level3 = "Steel Vorpal"
                        recruit = "Steel Slasher,Steel Oculus,Steel Impaler,Steel Wyrm,Steel Hedron,Steel Larva"
                    [/leader]
                    [leader]
                        level2 = "Steel Cataract"
                        level3 = "Steel Astigmatic"
                        recruit = "Steel Slasher,Steel Oculus,Steel Impaler,Steel Wyrm,Steel Hedron,Steel Larva"
                    [/leader]
                    [leader]
                        level2 = "Steel Skewer"
                        level3 = "Steel Dreadnought"
                        recruit = "Steel Slasher,Steel Oculus,Steel Impaler,Steel Wyrm,Steel Hedron,Steel Larva"
                    [/leader]
                [/group]

                # Nightmares
                [group]
                    allies_available="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17"
                    id = "wol_nightmares"
                    recruit = "Black Cat,Unhatched,Scornful Watcher,Life Thief,Howling Darkness,Unstable Elemental,Blood Bat"
                    [recall]
                        level2 = "Jinx Beast,Angry One,Shredder Spawn,Rash One,Spiteful Watcher,Soul Snatcher,Nature Wrath,Dread Bat"
                        level3 = "Calamity,Raging One,Ripper Beast,Reckless One,Inquisitor,Death Spectre,Eternal Night"
                    [/recall]
                    [commander]
                        level1 = "Black Cat,Unhatched,Scornful Watcher,Life Thief,Howling Darkness,Unstable Elemental,Blood Bat"
                        level2 = "Jinx Beast,Angry One,Shredder Spawn,Rash One,Spiteful Watcher,Soul Snatcher,Cloud of Gloom,Nature Wrath,Dread Bat"
                        level3 = "Calamity,Raging One,Ripper Beast,Reckless One,Inquisitor,Death Spectre,Eternal Night"
                    [/commander]
                    [leader]
                        level2 = "Angry One"
                        level3 = "Raging One"
                        recruit = "Black Cat,Unhatched,Scornful Watcher,Life Thief,Howling Darkness,Unstable Elemental,Blood Bat"
                    [/leader]
                    [leader]
                        level2 = "Soul Snatcher"
                        level3 = "Death Spectre"
                        recruit = "Black Cat,Unhatched,Scornful Watcher,Life Thief,Howling Darkness,Unstable Elemental,Blood Bat"
                    [/leader]
                    [leader]
                        level2 = "Cloud of Gloom"
                        level3 = "Eternal Night"
                        recruit = "Black Cat,Unhatched,Scornful Watcher,Life Thief,Howling Darkness,Unstable Elemental,Blood Bat"
                    [/leader]
                [/group]
            [/literal]
        [/set_variables]
    [/event]
[/resource]

# for world conquest
[resource]
    id=WOL_resource_WC_artifacts

    [world_conquest_data]
        #  [ignore]
        #      id = wc2_artifact_data
        #  [/ignore]
        {WOL_WC_ARTIFACT_DEFINITIONS}
    [/world_conquest_data]
[/resource]

# for world conquest

# Note: this #ifdef is used so as not to cause errors
# when loading this as it has WC2 specific defines inside

#ifdef LOAD_WC2
[resource]
    id=WOL_resource_WC_trainers

    [world_conquest_data]
        {WOL_WC_TRAINING_DEFINITIONS}
    [/world_conquest_data]
[/resource]
#endif

# teaching event resource
[resource]
    id=WOL_ability_teaching_event

    {ABILITY_WOL_TEACHING_EVENT}
[/resource]

# add RPG era specific Lua
[resource]
    id=WOL_RPG_ability_buff

    # adjust for leadership
    [event]
        name="unit_placed"
        first_time_only=no

        [filter]
            ability=leadership
        [/filter]

        [lua]
            [args]
                {ABILITY_LEADERSHIP}
                {ABILITY_ALLIED_LEADERSHIP}
            [/args]
            code=<<
                local leadership = wml.get_nth_child(..., "leadership", 1)
                local allied_leadership = wml.get_nth_child(..., "leadership", 2)
                    
                local effects = {
                    id = "WOL_add_allied_leadership",
                    wml.tag.effect {
                        apply_to = "remove_ability",
                        wml.tag.abilities {
                            wml.tag.leadership(leadership)
                        }
                    },
                    wml.tag.effect {
                        apply_to = "new_ability",
                        wml.tag.abilities {
                            wml.tag.allied_leadership(allied_leadership)
                        }
                    }
                }

                -- get target unit
                local ecx = wesnoth.current.event_context
                local unit = wesnoth.units.get(ecx.x1, ecx.y1)

                -- the leadership check is handled by WML side
                -- check if unit has been modified, if not, then execute
                if not unit.variables.rpg_adjusted then
                    unit:add_modification("object", effects)
                    -- do not allow it to stack
                    unit.variables.rpg_adjusted = true
                    -- debug message to check it worked or not
                    print("%s at (%d,%d) has been adjusted", unit.id, unit.x, unit.y)
                end
            >>
        [/lua]
    [/event]

    # adjust for inspires
    [event]
        name="unit_placed"
        first_time_only=no

        [filter]
            ability=inspire
        [/filter]

        [lua]
            [args]
                {ABILITY_INSPIRE}
                {ABILITY_ALLIED_INSPIRE}
            [/args]
            code=<<
                local inspire = wml.get_nth_child(..., "leadership", 1)
                local allied_inspire = wml.get_nth_child(..., "leadership", 2)
                    
                local effects = {
                    id = "WOL_add_allied_leadership",
                    wml.tag.effect {
                        apply_to = "remove_ability",
                        wml.tag.abilities {
                            wml.tag.leadership(inspire)
                        }
                    },
                    wml.tag.effect {
                        apply_to = "new_ability",
                        wml.tag.abilities {
                            wml.tag.allied_leadership(allied_inspire)
                        }
                    }
                }

                -- get target unit
                local ecx = wesnoth.current.event_context
                local unit = wesnoth.units.get(ecx.x1, ecx.y1)

                -- the leadership check is handled by WML side
                -- check if unit has been modified, if not, then execute
                if not unit.variables.rpg_adjusted then
                    unit:add_modification("object", effects)
                    -- do not allow it to stack
                    unit.variables.rpg_adjusted = true
                    -- debug message to check it worked or not
                    print("%s at (%d,%d) has been adjusted", unit.id, unit.x, unit.y)
                end
            >>
        [/lua]
    [/event]
[/resource]

# add new AMLA system
# this is cleaner

[resource]
    id=WOL_resource_AMLA_system_refactored

    [event]
        name="preload"
        first_time_only=no

        [lua]
            code= << wesnoth.require "~add-ons/War_of_Legends/lua/base.lua" >>
        [/lua]
        [lua]
            code= << wesnoth.require "~add-ons/War_of_Legends/lua/gui/amla_list.lua" >>
        [/lua]
    [/event]

    # add AMLA menu

    [event]
        name="prestart"

        {AMLA_MENU}
    [/event]

    [event]
        name=unit placed
        first_time_only=no
        id=WOL_add_standardised_AMLA

        [filter]
            [filter_wml]
                advances_to=null
            [/filter_wml]
        [/filter]

        #  [filter_conditional]
        #      [lua]
        #          code=<<
        #              return unit.variables.amla_added == false
        #          >>
        #      [/lua]
        #  [/filter_conditional]

        {IF_VAR $unit.variables.amla_added boolean_equals false (
            # remove the AMLA if already there
            # maybe I can remove this since
            # do it once time only
            [remove_object]
                id=$unit.id
                object_id=universal_amlas_object
            [/remove_object]

            # adjust unit
            [modify_unit]
                {WOL_FILTER id=$unit.id}
                [object]
                    id=universal_amlas_object
                    # remove the crappy AMLA default
                    {WOL_EFFECT remove_advancement amlas=amla_default}

                    #--------------------
                    # HITPOINTS
                    #--------------------
                    [effect]
                        apply_to=new_advancement
                        [advancement]
                            id,description=hitpoints_increase,_"Gain +8 hitpoints."
                            strict_amla,max_times=yes,-1
                            {WOL_EFFECT hitpoints increase_total=8}
                            {WOL_GLOBAL_AMLA_EFFECTS}
                        [/advancement]
                    [/effect]

                    #--------------------
                    # MELEE DAMAGE
                    #--------------------
                    [effect]
                        apply_to=new_advancement
                        [advancement]
                            id,description=melee_increase1,_"Gain +4 melee damage."
                            {WOL_FILTER_HAS_ATTACK_NOT_ATTACK range,number=melee,1 range,number=melee,2-99}
                            strict_amla,max_times=yes,-1
                            {WOL_EFFECT attack increase_damage,range=4,melee}
                            {WOL_GLOBAL_AMLA_EFFECTS}
                        [/advancement]
                    [/effect]
                    [effect]
                        apply_to=new_advancement
                        [advancement]
                            id,description=melee_increase1,_"Gain +2 melee damage."
                            {WOL_FILTER_HAS_ATTACK_NOT_ATTACK range,number=melee,2 range,number=melee,3-99}
                            strict_amla,max_times=yes,-1
                            {WOL_EFFECT attack increase_damage,range=2,melee}
                            {WOL_GLOBAL_AMLA_EFFECTS}
                        [/advancement]
                    [/effect]
                    [effect]
                        apply_to=new_advancement
                        [advancement]
                            id,description=melee_increase1,_"Gain +1 melee damage."
                            {WOL_FILTER_HAS_ATTACK range,number=melee,3-99}
                            strict_amla,max_times=yes,-1
                            {WOL_EFFECT attack increase_damage,range=1,melee}
                            {WOL_GLOBAL_AMLA_EFFECTS}
                        [/advancement]
                    [/effect]

                    #--------------------
                    # RANGED DAMAGE
                    #--------------------
                    [effect]
                        apply_to=new_advancement
                        [advancement]
                            id,description=melee_increase1,_"Gain +4 ranged damage."
                            {WOL_FILTER_HAS_ATTACK_NOT_ATTACK range,number=ranged,1 range,number=ranged,2-99}
                            strict_amla,max_times=yes,-1
                            {WOL_EFFECT attack increase_damage,range=4,ranged}
                            {WOL_GLOBAL_AMLA_EFFECTS}
                        [/advancement]
                    [/effect]
                    [effect]
                        apply_to=new_advancement
                        [advancement]
                            id,description=melee_increase1,_"Gain +2 ranged damage."
                            {WOL_FILTER_HAS_ATTACK_NOT_ATTACK range,number=ranged,2 range,number=ranged,3-99}
                            strict_amla,max_times=yes,-1
                            {WOL_EFFECT attack increase_damage,range=2,ranged}
                            {WOL_GLOBAL_AMLA_EFFECTS}
                        [/advancement]
                    [/effect]
                    [effect]
                        apply_to=new_advancement
                        [advancement]
                            id,description=melee_increase1,_"Gain +1 ranged damage."
                            {WOL_FILTER_HAS_ATTACK range,number=ranged,3-99}
                            strict_amla,max_times=yes,-1
                            {WOL_EFFECT attack increase_damage,range=1,ranged}
                            {WOL_GLOBAL_AMLA_EFFECTS}
                        [/advancement]
                    [/effect]
                [/object]
            [/modify_unit]

            [lua]
                code=<<
                -- get target unit
                local ecx = wesnoth.current.event_context
                local unit = wesnoth.units.get(ecx.x1, ecx.y1)
                -- switch it to true
                unit.variables.amla_added = true
                >>
            [/lua]
        )}
    [/event]
[/resource]

[resource]
    id=WOL_resource_AMLA_preview_only

    [event]
        name="preload"
        first_time_only=no

        [lua]
            code= << wesnoth.require "~add-ons/War_of_Legends/lua/base.lua" >>
        [/lua]
        [lua]
            code= << wesnoth.require "~add-ons/War_of_Legends/lua/gui/amla_list.lua" >>
        [/lua]
    [/event]

    # add AMLA menu

    [event]
        name="prestart"

        {AMLA_MENU}
    [/event]
[/resource]

# elementals
[resource]
    id=wol_elementals_reactions_events

    {WOL_FIRE_INFLICTION_EVENT}
    {WOL_COLD_INFLICTION_EVENT}
    {WOL_ELECTRIC_INFLICTION_EVENT}
[/resource]

# heroic leaders mod
[resource]
    id=knyght_wol_heroic_leaders_event

    [event]
        name=prestart
        [lua]
            # code = << wesnoth.require("~add-ons/War_of_Legends/lua/heroic_leaders.lua").promote_to_heroic_leaders(...) >>
            [args]
                {TRAIT_HEROIC}
            [/args]
            code = <<
            -- local trait_heroic = args[1][2]
            local trait_heroic = wml.get_nth_child(..., "trait", 1)
            for i, unit in ipairs(wesnoth.units.find_on_map { canrecruit = true }) do
                if not unit.variables.promoted_to_heroic_leader then
                    unit:add_modification("trait", trait_heroic )
                    unit.moves = unit.max_moves
                    unit.hitpoints = unit.max_hitpoints
                    -- do not allow it to stack
                    unit.variables.promoted_to_heroic_leader = true
                    -- debug message to check it worked or not
                    print("%s at (%d,%d) has been adjusted", unit.id, unit.x, unit.y)
                end
            end
            >>
        [/lua]
    [/event]
[/resource]
